# Metrics Monitoring System

Проект представляет собой систему мониторинга метрик, которая собирает данные о CPU и HTTP-запросах, периодически записывая их в лог-файл с временными метками.

## Особенности

- **Потокобезопасные метрики**: Использование атомарных операций для безопасного обновления значений
- **Периодическое логирование**: Автоматическая запись метрик в файл с настраиваемым интервалом
- **Поддержка различных типов метрик**:
  - `CPUMetric` для значений с плавающей точкой (CPU usage)
  - `HTTPMetric` для целочисленных значений (HTTP requests RPS)
- **Точное время**: Запись временных меток с миллисекундной точностью
- **Автоматическое сброс метрик**: После записи значений метрики автоматически сбрасываются

## Структура проекта

```
.
├── CMakeLists.txt
├── inc
│   └── metrics.hpp
├── src
│   ├── CMakeLists.txt
│   └── metrics.cpp
├── main.cpp
└── tests
    └── in
        └── 1test.in
```

## Сборка и запуск

### Требования
- Компилятор C++17
- CMake 3.14+

### Инструкция по сборке

```bash
mkdir build
cd build
cmake ..
cmake --build .
```

### Запуск приложения

```bash
./main < tests/in/1test.in
```

Файл с метриками будет создан в корне проекта: `metrics.log`

## Формат входных данных

Приложение принимает данные в формате:
```
<Тип метрики> <Значение>
```

Пример:
```
HTTP 42
CPU 0.97
HTTP 30
CPU 1.12
```

## Формат выходных данных

Лог-файл содержит записи в формате:
```
"<Временная метка>" "<Имя метрики>" <Значение> ...
```

Пример записи:
```
"2024-03-15 14:30:45.123" "CPU" 0.97 "HTTP requests RPS" 42
```

## Настройка

Основные параметры можно изменить в `main.cpp`:
- Интервал логирования (по умолчанию 500 мс)
- Путь к лог-файлу
- Имена метрик

## Пример использования

```cpp
// Создание логгера с интервалом 500 мс
MetricsLogger logger("metrics.log", std::chrono::milliseconds(500));

// Создание метрик
auto cpu = std::make_shared<CPUMetric>("CPU Usage");
auto http = std::make_shared<HTTPMetric>("HTTP Requests");

// Добавление метрик в логгер
logger.addMetric(cpu);
logger.addMetric(http);

// Обновление значений
cpu->update(0.85);
http->update(42);
```
